<!DOCTYPE html>
<html>
<head>
	<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.1/jquery.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
	<title></title>
	<div id="name"></div>
	<from id="form">
		<input type="text" name="input_name" id="input_name">
		<input type="button" name="setName" value="提交" onclick="setName()">
	</from>
</head>
<body>
	<script type="text/javascript">
		let contract
		$(function() {
		// 初始化 Web3
		  if (typeof web3 !== 'undefined') {
		      web3 = new Web3(web3.currentProvider);
		  } else {
		      web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:7545'));
		  }

		  // 设置默认账户
		  web3.eth.defaultAccount = web3.eth.accounts[0];
		  // 设置合约 ABI
		  var contractAbi = [
				{
					"inputs": [],
					"stateMutability": "nonpayable",
					"type": "constructor"
				},
				{
					"inputs": [],
					"name": "name",
					"outputs": [
						{
							"internalType": "string",
							"name": "",
							"type": "string"
						}
					],
					"stateMutability": "view",
					"type": "function"
				},
				{
					"inputs": [
						{
							"internalType": "string",
							"name": "_name",
							"type": "string"
						}
					],
					"name": "setName",
					"outputs": [],
					"stateMutability": "nonpayable",
					"type": "function"
				}
			]

		  // 设置合约地址
		  let contractAddress = '0x2F24dc8508b92bce277021C9671A8C89eF59C74f';
		  // 获取智能合约对象
		  contract = new web3.eth.Contract(contractAbi,contractAddress);
		  // 调用合约对象的方法，返回name
		  //$('#name').val(contract.methods.name().call())
		})

		function setName() {
			contract.methods.setName($('#input_name').val()).send({from: '0x2F24dc8508b92bce277021C9671A8C89eF59C74f'});
		}

	</script>

</body>
</html>